language: node_js

node_js:
- 8
- 12
- node

sudo: false

before_script:
  - npm install

script:
  - npm test

deploy:
  provider: npm
  email: engineering-managers@wikimedia.de
  api_key:
    secure: yes
  on:
    tags: true
    branch: master
    condition: "$TRAVIS_NODE_VERSION = 12"

notifications:
  irc:
    channels:
      - "chat.freenode.net#wikidata-feed"
    on_success: never
    on_failure: always
    template:
      - "%{repository}/%{branch}/%{commit} : %{author} %{message} %{build_url}"
